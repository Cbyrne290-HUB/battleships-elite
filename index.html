<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Battleship Pro 2026</title>
    <style>
        :root { --bg: #0f172a; --panel: #1e293b; --player: #3b82f6; --enemy: #ef4444; --accent: #10b981; }
        body { background: var(--bg); color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; }
        
        .game-layout { display: flex; gap: 30px; margin-top: 20px; }
        .controls { width: 200px; background: var(--panel); padding: 20px; border-radius: 8px; }
        
        /* Grid Styling */
        .grid { display: grid; grid-template-columns: repeat(10, 30px); grid-template-rows: repeat(10, 30px); gap: 2px; background: #334155; }
        .cell { width: 30px; height: 30px; background: var(--bg); cursor: pointer; display: flex; align-items: center; justify-content: center; }
        
        /* States */
        .cell.preview { background: rgba(59, 130, 246, 0.5); }
        .cell.ship { background: var(--player); border: 1px solid white; }
        .cell.hit { background: var(--enemy); }
        .cell.hit::after { content: "X"; }
        .cell.miss { background: #475569; }
        .cell.miss::after { content: "â€¢"; }

        /* Sidebar Buttons */
        .ship-btn { width: 100%; padding: 10px; margin: 5px 0; cursor: pointer; background: #475569; color: white; border: none; }
        .ship-btn.selected { background: var(--player); }
        #start-btn { width: 100%; padding: 15px; background: var(--accent); color: white; font-weight: bold; border: none; margin-top: 20px; display: none; cursor: pointer; }

        #win-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; color: black; padding: 50px; border-radius: 15px; text-align: center; box-shadow: 0 0 100px black; }
    </style>
</head>
<body>

    <h1>BATTLESHIP AI</h1>
    <h3 id="status-text">Select a ship from the left</h3>

    <div class="game-layout">
        <div class="controls" id="sidebar">
            <div id="ship-buttons">
                <button class="ship-btn" id="btn-5" onclick="pickShip(5, 'btn-5')">Carrier (5)</button>
                <button class="ship-btn" id="btn-4" onclick="pickShip(4, 'btn-4')">Battleship (4)</button>
                <button class="ship-btn" id="btn-3a" onclick="pickShip(3, 'btn-3a')">Submarine (3)</button>
                <button class="ship-btn" id="btn-3b" onclick="pickShip(3, 'btn-3b')">Destroyer (3)</button>
                <button class="ship-btn" id="btn-2" onclick="pickShip(2, 'btn-2')">Patrol Boat (2)</button>
            </div>
            <button onclick="rotate()">ROTATE</button>
            <button id="start-btn" onclick="lockIn()">LOCK IN & START</button>
        </div>

        <div>
            <p>Your Fleet</p>
            <div id="player-grid" class="grid"></div>
        </div>

        <div id="enemy-section" style="opacity: 0.3; pointer-events: none;">
            <p>Enemy Waters</p>
            <div id="enemy-grid" class="grid"></div>
        </div>
    </div>

    <div id="win-modal">
        <h2 id="winner">YOU WIN!</h2>
        <button onclick="location.reload()">PLAY AGAIN</button>
    </div>

<script>
    const pGrid = document.getElementById('player-grid');
    const eGrid = document.getElementById('enemy-grid');
    const status = document.getElementById('status-text');
    const startBtn = document.getElementById('start-btn');
    
    let horizontal = true;
    let currentSize = 0;
    let currentBtn = null;
    let shipsPlaced = 0;
    let playerShips = [];
    let enemyShips = [];
    let isTurn = false;

    // Create Grids
    function init() {
        for(let i=0; i<100; i++){
            let pCell = document.createElement('div');
            pCell.className = 'cell';
            pCell.onmouseover = () => showPreview(i);
            pCell.onmouseleave = () => clearPreview();
            pCell.onclick = () => placeShip(i);
            pGrid.appendChild(pCell);

            let eCell = document.createElement('div');
            eCell.className = 'cell';
            eCell.onclick = () => playerAttack(i);
            eGrid.appendChild(eCell);
        }
    }

    function rotate() { horizontal = !horizontal; }

    function pickShip(size, id) {
        currentSize = size;
        currentBtn = id;
        document.querySelectorAll('.ship-btn').forEach(b => b.classList.remove('selected'));
        document.getElementById(id).classList.add('selected');
    }

    function showPreview(idx) {
        if(!currentSize) return;
        clearPreview();
        const path = getPath(idx, currentSize);
        if(path) path.forEach(i => pGrid.children[i].classList.add('preview'));
    }

    function clearPreview() {
        Array.from(pGrid.children).forEach(c => c.classList.remove('preview'));
    }

    function getPath(idx, size) {
        let path = [];
        for(let i=0; i<size; i++) {
            let next = horizontal ? idx + i : idx + (i*10);
            if(next > 99 || (horizontal && Math.floor(next/10) !== Math.floor(idx/10))) return null;
            path.push(next);
        }
        return path;
    }

    function placeShip(idx) {
        if(!currentSize) return;
        const path = getPath(idx, currentSize);
        if(!path || path.some(i => playerShips.includes(i))) return;

        path.forEach(i => {
            playerShips.push(i);
            pGrid.children[i].classList.add('ship');
        });

        // REMOVE FROM SIDEBAR
        document.getElementById(currentBtn).remove();
        currentSize = 0;
        shipsPlaced++;
        
        if(shipsPlaced === 5) {
            startBtn.style.display = 'block';
            status.innerText = "All ships ready! Lock them in.";
        }
    }

    function lockIn() {
        document.getElementById('sidebar').style.display = 'none';
        document.getElementById('enemy-section').style.opacity = '1';
        document.getElementById('enemy-section').style.pointerEvents = 'auto';
        generateEnemy();
        isTurn = true;
        status.innerText = "GAME ON! Fire at the enemy.";
    }

    function generateEnemy() {
        const sizes = [5,4,3,3,2];
        sizes.forEach(s => {
            let placed = false;
            while(!placed) {
                let h = Math.random() > 0.5;
                let start = Math.floor(Math.random()*100);
                let path = [];
                for(let i=0; i<s; i++){
                    let n = h ? start + i : start + (i*10);
                    if(n < 100 && (!h || Math.floor(n/10) === Math.floor(start/10)) && !enemyShips.includes(n)) path.push(n);
                }
                if(path.length === s) {
                    enemyShips = [...enemyShips, ...path];
                    placed = true;
                }
            }
        });
    }

    function playerAttack(i) {
        if(!isTurn || eGrid.children[i].classList.contains('hit') || eGrid.children[i].classList.contains('miss')) return;
        
        if(enemyShips.includes(i)) {
            eGrid.children[i].classList.add('hit');
            enemyShips = enemyShips.filter(s => s !== i);
        } else {
            eGrid.children[i].classList.add('miss');
        }

        if(enemyShips.length === 0) return win("YOU WIN!");
        
        isTurn = false;
        status.innerText = "AI is aiming...";
        setTimeout(aiAttack, 800);
    }

    function aiAttack() {
        let rand;
        do { rand = Math.floor(Math.random()*100); } 
        while(pGrid.children[rand].classList.contains('hit') || pGrid.children[rand].classList.contains('miss'));

        if(playerShips.includes(rand)) {
            pGrid.children[rand].classList.add('hit');
            playerShips = playerShips.filter(s => s !== rand);
        } else {
            pGrid.children[rand].classList.add('miss');
        }

        if(playerShips.length === 0) return win("AI WINS!");
        isTurn = true;
        status.innerText = "Your Turn!";
    }

    function win(txt) {
        document.getElementById('winner').innerText = txt;
        document.getElementById('win-modal').style.display = 'block';
    }

    init();
</script>
</body>
</html>
